



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.14">
    
    
      
        <title>API - TensorCross</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d3202873.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.ff0a5ce4.min.css">
      
      
        
        
        <meta name="theme-color" content="#ffa724">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="orange" data-md-color-accent="grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tensorcross" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="TensorCross" class="md-header-nav__button md-logo" aria-label="TensorCross">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            TensorCross
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              API
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TensorCross" class="md-nav__button md-logo" aria-label="TensorCross">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    TensorCross
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Start" class="md-nav__link">
      Start
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="API" class="md-nav__link md-nav__link--active">
      API
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tensorcross" class="md-nav__link">
    tensorcross
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tensorcross.model_selection" class="md-nav__link">
    model_selection
  </a>
  
    <nav class="md-nav" aria-label="model_selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search" class="md-nav__link">
    search
  </a>
  
    <nav class="md-nav" aria-label="search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.BaseSearch" class="md-nav__link">
    BaseSearch
  </a>
  
    <nav class="md-nav" aria-label="BaseSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.BaseSearch.summary" class="md-nav__link">
    summary()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.GridSearch" class="md-nav__link">
    GridSearch
  </a>
  
    <nav class="md-nav" aria-label="GridSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.GridSearch.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.GridSearch.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.RandomSearch" class="md-nav__link">
    RandomSearch
  </a>
  
    <nav class="md-nav" aria-label="RandomSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.RandomSearch.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.RandomSearch.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv" class="md-nav__link">
    search_cv
  </a>
  
    <nav class="md-nav" aria-label="search_cv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.BaseSearchCV" class="md-nav__link">
    BaseSearchCV
  </a>
  
    <nav class="md-nav" aria-label="BaseSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.BaseSearchCV.summary" class="md-nav__link">
    summary()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.GridSearchCV" class="md-nav__link">
    GridSearchCV
  </a>
  
    <nav class="md-nav" aria-label="GridSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.GridSearchCV.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.GridSearchCV.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.RandomSearchCV" class="md-nav__link">
    RandomSearchCV
  </a>
  
    <nav class="md-nav" aria-label="RandomSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.RandomSearchCV.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.RandomSearchCV.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tensorcross.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.utils.dataset" class="md-nav__link">
    dataset
  </a>
  
    <nav class="md-nav" aria-label="dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.utils.dataset.dataset_split" class="md-nav__link">
    dataset_split()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tensorcross" class="md-nav__link">
    tensorcross
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tensorcross.model_selection" class="md-nav__link">
    model_selection
  </a>
  
    <nav class="md-nav" aria-label="model_selection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search" class="md-nav__link">
    search
  </a>
  
    <nav class="md-nav" aria-label="search">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.BaseSearch" class="md-nav__link">
    BaseSearch
  </a>
  
    <nav class="md-nav" aria-label="BaseSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.BaseSearch.summary" class="md-nav__link">
    summary()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.GridSearch" class="md-nav__link">
    GridSearch
  </a>
  
    <nav class="md-nav" aria-label="GridSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.GridSearch.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.GridSearch.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.RandomSearch" class="md-nav__link">
    RandomSearch
  </a>
  
    <nav class="md-nav" aria-label="RandomSearch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.RandomSearch.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search.RandomSearch.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv" class="md-nav__link">
    search_cv
  </a>
  
    <nav class="md-nav" aria-label="search_cv">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.BaseSearchCV" class="md-nav__link">
    BaseSearchCV
  </a>
  
    <nav class="md-nav" aria-label="BaseSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.BaseSearchCV.summary" class="md-nav__link">
    summary()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.GridSearchCV" class="md-nav__link">
    GridSearchCV
  </a>
  
    <nav class="md-nav" aria-label="GridSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.GridSearchCV.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.GridSearchCV.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.RandomSearchCV" class="md-nav__link">
    RandomSearchCV
  </a>
  
    <nav class="md-nav" aria-label="RandomSearchCV">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.RandomSearchCV.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorcross.model_selection.search_cv.RandomSearchCV.fit" class="md-nav__link">
    fit()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tensorcross.utils" class="md-nav__link">
    utils
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.utils.dataset" class="md-nav__link">
    dataset
  </a>
  
    <nav class="md-nav" aria-label="dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tensorcross.utils.dataset.dataset_split" class="md-nav__link">
    dataset_split()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>API</h1>
                
                <div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#tensorcross" id="tensorcross" style="visibility: hidden; position: absolute;">
        </h2>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="tensorcross.model_selection">

        <code>model_selection</code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="tensorcross.model_selection.search">

        <code>search</code>


      </h3>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="tensorcross.model_selection.search.BaseSearch">

        <code>BaseSearch</code>


      </h4>
<div class="doc doc-contents ">
<p>Abstract BaseSearch class for the grid or random search.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_fn</code></td>
<td><code>Callable[..., tf.keras.models.Model]</code></td>
<td>
<p>Function that
builds and compiles a tf.keras.models.Model object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Whether to show information in terminal.
Defaults to 0.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the model_fn function.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search.BaseSearch.summary">

        <code class="highlight language-python">
summary<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      </h5>
<div class="doc doc-contents ">
<p>Prints the summary of the search to the console.</p>
<p>Assuming the <em>RandomSearch</em> had n iterations or the
<em>GridSearch</em> had n combinations in total, the output
would have the following structure:
<div class="highlight">
<pre><span></span><code>    --------------------------------------------------
    Best score: ``float`` using params: ``dict``
    --------------------------------------------------
    Idx: 0   - Score: ``float`` using params: ``dict``
    ...
    Idx: n-1 - Score: ``float`` using params: ``dict``
    --------------------------------------------------
</code></pre>
</div>
</p>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Prints the summary of the search to the console.</span>

<span class="sd">    Assuming the *RandomSearch* had n iterations or the</span>
<span class="sd">    *GridSearch* had n combinations in total, the output</span>
<span class="sd">    would have the following structure:</span>
<span class="sd">    ```</span>
<span class="sd">        --------------------------------------------------</span>
<span class="sd">        Best score: ``float`` using params: ``dict``</span>
<span class="sd">        --------------------------------------------------</span>
<span class="sd">        Idx: 0   - Score: ``float`` using params: ``dict``</span>
<span class="sd">        ...</span>
<span class="sd">        Idx: n-1 - Score: ``float`` using params: ``dict``</span>
<span class="sd">        --------------------------------------------------</span>
<span class="sd">    ```</span>
<span class="sd">    """</span>
    <span class="n">best_params_str</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">"Best score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s1">'best_score'</span><span class="p">]</span><span class="si">}</span><span class="s2"> "</span>
                       <span class="sa">f</span><span class="s2">"using params: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s1">'best_params'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">dashed_line</span> <span class="o">=</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">best_params_str</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="si">{</span><span class="n">dashed_line</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">best_params_str</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">dashed_line</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s2">"val_scores"</span><span class="p">]</span>
    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s2">"params"</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">params</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Idx: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> - Score: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2"> with param: </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">dashed_line</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="tensorcross.model_selection.search.GridSearch">

        <code>GridSearch</code>


      </h4>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search.GridSearch.__init__">

        <code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fn</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h5>
<div class="doc doc-contents ">
<p>GridSearch for a given parameter grid.</p>
<p>The grid search is evaluated by the either the validation loss value,
if no metrics are passed to the compile function, or the
validation score of the last defined metric is used.
<div class="highlight">
<pre><span></span><code>    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"mse"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"mse"</span><span class="p">,</span> <span class="s2">"mae"</span><span class="p">])</span>
</code></pre>
</div>
</p>
<p>This would sort the grid search combinations based on the validation
mae score.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_fn</code></td>
<td><code>Callable[..., tensorflow.python.keras.engine.training.Model]</code></td>
<td>
<p>Function that
builds and compiles a tf.keras.models.Model object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>param_grid</code></td>
<td><code>Mapping[str, Iterable]</code></td>
<td>
<p>Dict of str, iterable
hyperparameter, where the str is the parameter name of the.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Whether to show information in terminal.
Defaults to 0.</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the model_fn function.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">],</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""GridSearch for a given parameter grid.</span>

<span class="sd">    The grid search is evaluated by the either the validation loss value,</span>
<span class="sd">    if no metrics are passed to the compile function, or the</span>
<span class="sd">    validation score of the last defined metric is used.</span>
<span class="sd">    ``` python</span>
<span class="sd">        model.compile(loss="mse", metrics=["mse", "mae"])</span>
<span class="sd">    ```</span>

<span class="sd">    This would sort the grid search combinations based on the validation</span>
<span class="sd">    mae score.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_fn (Callable[..., tf.keras.models.Model]): Function that</span>
<span class="sd">            builds and compiles a tf.keras.models.Model object.</span>
<span class="sd">        param_grid (Mapping[str, Iterable]): Dict of str, iterable</span>
<span class="sd">            hyperparameter, where the str is the parameter name of the.</span>
<span class="sd">        verbose (int): Whether to show information in terminal.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the model_fn function.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">model_fn</span><span class="o">=</span><span class="n">model_fn</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span> <span class="o">=</span> <span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search.GridSearch.fit">

        <code class="highlight language-python">
fit<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">val_dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>


      </h5>
<div class="doc doc-contents ">
<p>Runs the exhaustive grid search over the parameter grid.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>train_dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>tf.data.Dataset object for the
training.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>val_dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>tf.data.Dataset object for
the validation.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the fit method of the
tf.keras.models.Model or tf.keras.models.Sequential model.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="n">val_dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Runs the exhaustive grid search over the parameter grid.</span>

<span class="sd">    Args:</span>
<span class="sd">        train_dataset (tf.data.Dataset): tf.data.Dataset object for the</span>
<span class="sd">            training.</span>
<span class="sd">        val_dataset (tf.data.Dataset): tf.data.Dataset object for</span>
<span class="sd">            the validation.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the fit method of the</span>
<span class="sd">            tf.keras.models.Model or tf.keras.models.Sequential model.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span>
        <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
        <span class="n">val_dataset</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
        <span class="n">parameter_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="tensorcross.model_selection.search.RandomSearch">

        <code>RandomSearch</code>


      </h4>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search.RandomSearch.__init__">

        <code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fn</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h5>
<div class="doc doc-contents ">
<p>RandomSearch for a given parameter distribution.</p>
<p>The random search is evaluated by the either the validation loss value,
if no metrics are passed to the compile function, or the
validation score of the last defined metric is used.
<div class="highlight">
<pre><span></span><code>    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"mse"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"mse"</span><span class="p">,</span> <span class="s2">"mae"</span><span class="p">])</span>
</code></pre>
</div>
</p>
<p>This would sort the random search combinations based on the validation
mae score.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_fn</code></td>
<td><code>Callable[..., tensorflow.python.keras.engine.training.Model]</code></td>
<td>
<p>Function that
builds and compiles a tf.keras.models.Model object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>param_distributions</code></td>
<td><code>Dict[str, Callable]</code></td>
<td>
<p>Dict of str, callable
pairs, where the str is the parameter name of the.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>n_iter</code></td>
<td><code>int</code></td>
<td>
<p>Number of random models. Defaults to 10.</p>
</td>
<td><code>10</code></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Whether to show information in terminal.
Defaults to 0.</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the model_fn function.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">],</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""RandomSearch for a given parameter distribution.</span>

<span class="sd">    The random search is evaluated by the either the validation loss value,</span>
<span class="sd">    if no metrics are passed to the compile function, or the</span>
<span class="sd">    validation score of the last defined metric is used.</span>
<span class="sd">    ``` python</span>
<span class="sd">        model.compile(loss="mse", metrics=["mse", "mae"])</span>
<span class="sd">    ```</span>

<span class="sd">    This would sort the random search combinations based on the validation</span>
<span class="sd">    mae score.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_fn (Callable[..., tf.keras.models.Model]): Function that</span>
<span class="sd">            builds and compiles a tf.keras.models.Model object.</span>
<span class="sd">        param_distributions (Dict[str, Callable]): Dict of str, callable</span>
<span class="sd">            pairs, where the str is the parameter name of the.</span>
<span class="sd">        n_iter (int): Number of random models. Defaults to 10.</span>
<span class="sd">        verbose (int): Whether to show information in terminal.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the model_fn function.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">model_fn</span><span class="o">=</span><span class="n">model_fn</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">param_distributions</span> <span class="o">=</span> <span class="n">param_distributions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span> <span class="o">=</span> <span class="n">n_iter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">random_sampler</span> <span class="o">=</span> <span class="n">ParameterSampler</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_distributions</span><span class="p">,</span>
        <span class="n">n_iter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search.RandomSearch.fit">

        <code class="highlight language-python">
fit<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">val_dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>


      </h5>
<div class="doc doc-contents ">
<p>Runs the random search over the parameter distributions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>train_dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>tf.data.Dataset object for the
training.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>val_dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>tf.data.Dataset object for
the validation.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the fit method of the
tf.keras.models.Model or tf.keras.models.Sequential model.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="n">val_dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Runs the random search over the parameter distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        train_dataset (tf.data.Dataset): tf.data.Dataset object for the</span>
<span class="sd">            training.</span>
<span class="sd">        val_dataset (tf.data.Dataset): tf.data.Dataset object for</span>
<span class="sd">            the validation.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the fit method of the</span>
<span class="sd">            tf.keras.models.Model or tf.keras.models.Sequential model.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span>
        <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
        <span class="n">val_dataset</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
        <span class="n">parameter_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_sampler</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="tensorcross.model_selection.search_cv">

        <code>search_cv</code>


      </h3>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="tensorcross.model_selection.search_cv.BaseSearchCV">

        <code>BaseSearchCV</code>


      </h4>
<div class="doc doc-contents ">
<p>Abstract BaseSearchCV class for the grid or random search
with cross validation.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_fn</code></td>
<td><code>Callable[..., tf.keras.models.Model]</code></td>
<td>
<p>Function that
builds and compiles a tf.keras.models.Model object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>n_folds</code></td>
<td><code>int</code></td>
<td>
<p>How many folds. Defaults to 3.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Whether to show information in terminal.
Defaults to 0.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the model_fn function.</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search_cv.BaseSearchCV.summary">

        <code class="highlight language-python">
summary<span class="p">(</span><span class="bp">self</span><span class="p">)</span>        </code>


      </h5>
<div class="doc doc-contents ">
<p>Prints the summary of the search to the console.</p>
<p>Assuming the <em>RandomSearch</em> had n iterations or the
<em>GridSearch</em> had n combinations in total, the output
would have the following structure:
<div class="highlight">
<pre><span></span><code>    --------------------------------------------------
    Best score: ``float`` using params: ``dict``
    --------------------------------------------------
    Idx: 0   - Score: ``float`` using params: ``dict``
    ...
    Idx: n-1 - Score: ``float`` using params: ``dict``
    --------------------------------------------------
</code></pre>
</div>
</p>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search_cv.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Prints the summary of the search to the console.</span>

<span class="sd">    Assuming the *RandomSearch* had n iterations or the</span>
<span class="sd">    *GridSearch* had n combinations in total, the output</span>
<span class="sd">    would have the following structure:</span>
<span class="sd">    ```</span>
<span class="sd">        --------------------------------------------------</span>
<span class="sd">        Best score: ``float`` using params: ``dict``</span>
<span class="sd">        --------------------------------------------------</span>
<span class="sd">        Idx: 0   - Score: ``float`` using params: ``dict``</span>
<span class="sd">        ...</span>
<span class="sd">        Idx: n-1 - Score: ``float`` using params: ``dict``</span>
<span class="sd">        --------------------------------------------------</span>
<span class="sd">    ```</span>
<span class="sd">    """</span>
    <span class="n">best_params_str</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">"Best score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s1">'best_score'</span><span class="p">]</span><span class="si">}</span><span class="s2"> "</span>
                       <span class="sa">f</span><span class="s2">"using params: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s1">'best_params'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">dashed_line</span> <span class="o">=</span> <span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">"-"</span><span class="p">,</span> <span class="n">best_params_str</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="si">{</span><span class="n">dashed_line</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">best_params_str</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">dashed_line</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s2">"val_scores"</span><span class="p">]</span>
    <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">results_</span><span class="p">[</span><span class="s2">"params"</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">params</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Idx: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> - Score: </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2"> with param: </span><span class="si">{</span><span class="n">param</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">dashed_line</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="tensorcross.model_selection.search_cv.GridSearchCV">

        <code>GridSearchCV</code>


      </h4>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search_cv.GridSearchCV.__init__">

        <code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fn</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h5>
<div class="doc doc-contents ">
<p>GridSearch for a given parameter grid.</p>
<p>The grid search is evaluated by the either the validation loss value,
if no metrics are passed to the compile function, or the
validation score of the last defined metric is used.
<div class="highlight">
<pre><span></span><code>    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"mse"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"mse"</span><span class="p">,</span> <span class="s2">"mae"</span><span class="p">])</span>
</code></pre>
</div>
</p>
<p>This would sort the grid search combinations based on the validation
mae score.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_fn</code></td>
<td><code>Callable[..., tensorflow.python.keras.engine.training.Model]</code></td>
<td>
<p>Function that
builds and compiles a tf.keras.models.Model object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>param_grid</code></td>
<td><code>Mapping[str, Iterable]</code></td>
<td>
<p>Dict of str, iterable
hyperparameter, where the str is the parameter name of the.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>n_folds</code></td>
<td><code>int</code></td>
<td>
<p>How many folds. Defaults to 3.</p>
</td>
<td><code>3</code></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Whether to show information in terminal.
Defaults to 0.</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the model_fn function.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search_cv.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">],</span>
    <span class="n">param_grid</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">],</span>
    <span class="n">n_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""GridSearch for a given parameter grid.</span>

<span class="sd">    The grid search is evaluated by the either the validation loss value,</span>
<span class="sd">    if no metrics are passed to the compile function, or the</span>
<span class="sd">    validation score of the last defined metric is used.</span>
<span class="sd">    ``` python</span>
<span class="sd">        model.compile(loss="mse", metrics=["mse", "mae"])</span>
<span class="sd">    ```</span>

<span class="sd">    This would sort the grid search combinations based on the validation</span>
<span class="sd">    mae score.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_fn (Callable[..., tf.keras.models.Model]): Function that</span>
<span class="sd">            builds and compiles a tf.keras.models.Model object.</span>
<span class="sd">        param_grid (Mapping[str, Iterable]): Dict of str, iterable</span>
<span class="sd">            hyperparameter, where the str is the parameter name of the.</span>
<span class="sd">        n_folds (int): How many folds. Defaults to 3.</span>
<span class="sd">        verbose (int): Whether to show information in terminal.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the model_fn function.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">model_fn</span><span class="o">=</span><span class="n">model_fn</span><span class="p">,</span>
        <span class="n">n_folds</span><span class="o">=</span><span class="n">n_folds</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span> <span class="o">=</span> <span class="n">ParameterGrid</span><span class="p">(</span><span class="n">param_grid</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search_cv.GridSearchCV.fit">

        <code class="highlight language-python">
fit<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>


      </h5>
<div class="doc doc-contents ">
<p>Runs the exhaustive grid search over the parameter grid.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>tf.data.Dataset object for the training.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the fit method of the
tf.keras.models.Model or tf.keras.models.Sequential model.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search_cv.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Runs the exhaustive grid search over the parameter grid.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (tf.data.Dataset): tf.data.Dataset object for the training.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the fit method of the</span>
<span class="sd">            tf.keras.models.Model or tf.keras.models.Sequential model.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">parameter_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="tensorcross.model_selection.search_cv.RandomSearchCV">

        <code>RandomSearchCV</code>


      </h4>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search_cv.RandomSearchCV.__init__">

        <code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_fn</span><span class="p">,</span> <span class="n">param_distributions</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h5>
<div class="doc doc-contents ">
<p>RandomSearch for a given parameter distribution.</p>
<p>The random search is evaluated by the either the validation loss value,
if no metrics are passed to the compile function, or the
validation score of the last defined metric is used.
<div class="highlight">
<pre><span></span><code>    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"mse"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">"mse"</span><span class="p">,</span> <span class="s2">"mae"</span><span class="p">])</span>
</code></pre>
</div>
</p>
<p>This would sort the random search combinations based on the validation
mae score.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_fn</code></td>
<td><code>Callable[..., tensorflow.python.keras.engine.training.Model]</code></td>
<td>
<p>Function that
builds and compiles a tf.keras.models.Model object.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>param_distributions</code></td>
<td><code>Dict[str, Callable]</code></td>
<td>
<p>Dict of str, callable
pairs, where the str is the parameter name of the.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>n_iter</code></td>
<td><code>int</code></td>
<td>
<p>Number of random models. Defaults to 10.</p>
</td>
<td><code>10</code></td>
</tr>
<tr>
<td><code>n_folds</code></td>
<td><code>int</code></td>
<td>
<p>How many folds. Defaults to 3.</p>
</td>
<td><code>3</code></td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td>
<p>Whether to show information in terminal.
Defaults to 0.</p>
</td>
<td><code>0</code></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the model_fn function.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search_cv.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">],</span>
    <span class="n">param_distributions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span>
    <span class="n">n_iter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">n_folds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""RandomSearch for a given parameter distribution.</span>

<span class="sd">    The random search is evaluated by the either the validation loss value,</span>
<span class="sd">    if no metrics are passed to the compile function, or the</span>
<span class="sd">    validation score of the last defined metric is used.</span>
<span class="sd">    ``` python</span>
<span class="sd">        model.compile(loss="mse", metrics=["mse", "mae"])</span>
<span class="sd">    ```</span>

<span class="sd">    This would sort the random search combinations based on the validation</span>
<span class="sd">    mae score.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_fn (Callable[..., tf.keras.models.Model]): Function that</span>
<span class="sd">            builds and compiles a tf.keras.models.Model object.</span>
<span class="sd">        param_distributions (Dict[str, Callable]): Dict of str, callable</span>
<span class="sd">            pairs, where the str is the parameter name of the.</span>
<span class="sd">        n_iter (int): Number of random models. Defaults to 10.</span>
<span class="sd">        n_folds (int): How many folds. Defaults to 3.</span>
<span class="sd">        verbose (int): Whether to show information in terminal.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the model_fn function.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">model_fn</span><span class="o">=</span><span class="n">model_fn</span><span class="p">,</span>
        <span class="n">n_folds</span><span class="o">=</span><span class="n">n_folds</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">param_distributions</span> <span class="o">=</span> <span class="n">param_distributions</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span> <span class="o">=</span> <span class="n">n_iter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">random_sampler</span> <span class="o">=</span> <span class="n">ParameterSampler</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_distributions</span><span class="p">,</span>
        <span class="n">n_iter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h5 class="doc doc-heading" id="tensorcross.model_selection.search_cv.RandomSearchCV.fit">

        <code class="highlight language-python">
fit<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>        </code>


      </h5>
<div class="doc doc-contents ">
<p>Runs the random search over the parameter distributions.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>tf.data.Dataset object for the training.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>kwargs</code></td>
<td><code>Any</code></td>
<td>
<p>Keyword arguments for the fit method of the
tf.keras.models.Model or tf.keras.models.Sequential model.</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\model_selection\search_cv.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""Runs the random search over the parameter distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (tf.data.Dataset): tf.data.Dataset object for the training.</span>
<span class="sd">        kwargs (Any): Keyword arguments for the fit method of the</span>
<span class="sd">            tf.keras.models.Model or tf.keras.models.Sequential model.</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_run_search</span><span class="p">(</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">parameter_obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_sampler</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="tensorcross.utils">

        <code>utils</code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

      </h2>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="tensorcross.utils.dataset">

        <code>dataset</code>


      </h3>
<div class="doc doc-contents ">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="tensorcross.utils.dataset.dataset_split">

        <code class="highlight language-python">
dataset_split<span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">split_fraction</span><span class="p">,</span> <span class="n">fold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>        </code>


      </h4>
<div class="doc doc-contents ">
<p>Splits the dataset into one chunk with split_fraction many elements of
the original dataset and another chunk with size (1 - split_fraction)
elements.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dataset</code></td>
<td><code>DatasetV2</code></td>
<td>
<p>Dataset to be splitted.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>split_fraction</code></td>
<td><code>float</code></td>
<td>
<p>Fraction of the dataset split.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>fold</code></td>
<td><code>int</code></td>
<td>
<p>Which fold of the dataset, the validation set should be.</p>
</td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Tuple[tensorflow.python.data.ops.dataset_ops.DatasetV2, tensorflow.python.data.ops.dataset_ops.DatasetV2]</code></td>
<td>
<p>Tuple[tf.data.Dataset, tf.data.Dataset]: Splitted datasets tuple.</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
          <summary>Source code in <code>tensorcross\utils\dataset.py</code></summary>
          <table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">dataset_split</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
    <span class="n">split_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">fold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">]:</span>
    <span class="sd">"""Splits the dataset into one chunk with split_fraction many elements of</span>
<span class="sd">    the original dataset and another chunk with size (1 - split_fraction)</span>
<span class="sd">    elements.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset (tf.data.Dataset): Dataset to be splitted.</span>
<span class="sd">        split_fraction (float): Fraction of the dataset split.</span>
<span class="sd">        fold (int): Which fold of the dataset, the validation set should be.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[tf.data.Dataset, tf.data.Dataset]: Splitted datasets tuple.</span>
<span class="sd">    """</span>
    <span class="n">split_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span> <span class="o">*</span> <span class="n">split_fraction</span><span class="p">)</span>
    <span class="n">offset_idx</span> <span class="o">=</span> <span class="n">fold</span> <span class="o">*</span> <span class="n">split_size</span>
    <span class="n">val_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">offset_idx</span><span class="p">)</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">split_size</span><span class="p">)</span>
    <span class="n">first_train_folds</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">offset_idx</span><span class="p">)</span>
    <span class="n">last_train_folds</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">offset_idx</span> <span class="o">+</span> <span class="n">split_size</span><span class="p">)</span>
    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">first_train_folds</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">last_train_folds</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">val_dataset</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href=".." title="Start" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Start
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.2d1db4bd.min.js"></script>
      <script src="../assets/javascripts/bundle.6627ddf3.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>